define("events",["underscore"],function(t){var e,n,i,s,o=/\s+/;return n=function(t,e,n,i){if(!n)return!0;if("object"==typeof n){for(var s in n)t[e].apply(t,[s,n[s]].concat(i));return!1}if(o.test(n)){for(var r=n.split(o),a=0,c=r.length;c>a;a++)t[e].apply(t,[r[a]].concat(i));return!1}return!0},s=function(t,e){var n,i=-1,s=t.length,o=e[0],r=e[1],a=e[2];switch(e.length){case 0:for(;++i<s;)(n=t[i]).callback.call(n.ctx);return;case 1:for(;++i<s;)(n=t[i]).callback.call(n.ctx,o);return;case 2:for(;++i<s;)(n=t[i]).callback.call(n.ctx,o,r);return;case 3:for(;++i<s;)(n=t[i]).callback.call(n.ctx,o,r,a);return;default:for(;++i<s;)(n=t[i]).callback.apply(n.ctx,e)}},e={on:function(t,e,i){if(!n(this,"on",t,[e,i])||!e)return this;this._events||(this._events={});var s=this._events[t]||(this._events[t]=[]);return s.push({callback:e,context:i,ctx:i||this}),this},once:function(e,i,s){if(!n(this,"once",e,[i,s])||!i)return this;var o=this,r=t.once(function(){o.off(e,r),i.apply(this,arguments)});return r._callback=i,this.on(e,r,s)},off:function(e,i,s){var o,r,a,c,u,l,h,f;if(!this._events||!n(this,"off",e,[i,s]))return this;if(!e&&!i&&!s)return this._events={},this;for(c=e?[e]:t.keys(this._events),u=0,l=c.length;l>u;u++)if(e=c[u],a=this._events[e]){if(this._events[e]=o=[],i||s)for(h=0,f=a.length;f>h;h++)r=a[h],(i&&i!==r.callback&&i!==r.callback._callback||s&&s!==r.context)&&o.push(r);o.length||delete this._events[e]}return this},trigger:function(t){if(!this._events)return this;var e=Array.prototype.slice.call(arguments,1);if(!n(this,"trigger",t,e))return this;var i=this._events[t],o=this._events.all;return i&&s(i,e),o&&s(o,arguments),this},stopListening:function(t,e,n){var i=this._listeners;if(!i)return this;var s=!e&&!n;"object"==typeof e&&(n=this),t&&((i={})[t._listenerId]=t);for(var o in i)i[o].off(e,n,this),s&&delete this._listeners[o];return this}},i={listenTo:"on",listenToOnce:"once"},t.each(i,function(n,i){e[i]=function(e,i,s){var o=this._listeners||(this._listeners={}),r=e._listenerId||(e._listenerId=t.uniqueId("l"));return o[r]=e,"object"==typeof i&&(s=this),e[n](i,s,this),this}}),e}),define("extend",["underscore"],function(t){return function(e,n){var i,s,o=this;return s=e&&t.has(e,"constructor")?e.constructor:function(){return o.apply(this,arguments)},t.extend(s,o,n),i=function(){this.constructor=s},i.prototype=o.prototype,s.prototype=new i,e&&t.extend(s.prototype,e),s.__super__=o.prototype,e.name&&(s.prototype.toString=function(){return e.name}),s}}),define("baseModel",["underscore","events","extend"],function(t,e,n){var i=function(n){n=n||{},t.extend(this,e,{idAttribute:"id",invalid:function(){return localStorage?this.name?void 0:{error:!0,message:"This model has no name. Every model needs a name"}:{error:!0,message:"There is no localStorage available in this context"}},save:function(t,e){return t[this.idAttribute]?this.update(t[this.idAttribute],t,e):this.insert(t,e)}},n)};return i.extend=n,i}),define("localStorageModel",["baseModel"],function(t){return t.extend({find:function(t,e){var n,i=[];if(e=e||t,this.invalid())e(this.invalid(t));else{for(var s in localStorage)if(~s.indexOf(this.name+"-")){n=!0;for(var o in t)t[o]!==JSON.parse(localStorage[s])[o]&&(n=!1);n&&i.push(JSON.parse(localStorage.getItem(s)))}e(i)}},findOne:function(t,e){this.invalid()?e(this.invalid()):e(JSON.parse(localStorage[this.name+"-"+t]||"{}"))},insert:function(t,e){e=e||function(){},t[this.idAttribute]=(new Date).getTime(),this.invalid(t)?e(this.invalid(t)):(localStorage[this.name+"-"+t.id]=JSON.stringify(t),e(t))},remove:function(t,e){e=e||function(){},this.invalid()?e(this.invalid()):(delete localStorage[this.name+"-"+t],e(null))},update:function(t,e,n){n=n||function(){},this.invalid(e)?n(this.invalid(e)):(e[this.idAttribute]=t,localStorage[this.name+"-"+t]=JSON.stringify(e),n(e))}})}),define("ajax",[],function(){return function(t,e){var n,i=this;this.updating=!1,this.abort=function(){i.updating&&(i.updating=!1,i.AJAX.abort(),i.AJAX=null)},this.update=function(t,e){return i.updating?!1:(i.AJAX=null,i.AJAX=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),null===i.AJAX?!1:(i.AJAX.onreadystatechange=function(){4===i.AJAX.readyState&&(i.updating=!1,i.callback(i.AJAX.responseText,i.AJAX.status,i.AJAX.responseXML),i.AJAX=null)},i.updating=new Date,/post/i.test(e)?(n=s+"?"+i.updating.getTime(),i.AJAX.open("POST",n,!0),i.AJAX.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.AJAX.send(t)):/put/i.test(e)?(n=s+"?"+i.updating.getTime(),i.AJAX.open("PUT",n,!0),i.AJAX.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.AJAX.send(t)):(n=s+"?"+t+"&timestamp="+i.updating.getTime(),i.AJAX.open("GET",n,!0),i.AJAX.send(null)),!0))};var s=t;this.callback=e||function(){}}}),define("httpModel",["baseModel","ajax","underscore"],function(t,e,n){return t.extend({suffix:"",urlRoot:function(){return(this.name?"/"+this.name:"")+"/"},ajax:function(t){var i;"function"==typeof $&&$.ajax?$.ajax(n.extend({success:function(e){t.complete(e)}.bind(this),error:function(e){t.complete({error:!0,message:e})}.bind(this)},t)):(i=new e(t.url,function(e){n.isFunction(t.complete)&&t.complete(JSON.parse(e))}),i.update((JSON.stringify(t.data)||"").replace(/:/g,"=").replace(/"/g,"").replace(/,/g,"&").replace(/{/g,"").replace(/}/g,""),t.method))},find:function(t,e){this.ajax({url:this.urlRoot()+this.suffix,method:"GET",data:t,complete:e||t})},findOne:function(t,e){this.ajax({url:this.urlRoot()+t+this.suffix,method:"GET",complete:e})},insert:function(t,e){e=e||function(){},this.ajax({url:this.urlRoot()+this.suffix,method:"POST",data:t,complete:e})},remove:function(t,e){e=e||function(){},this.ajax({url:this.urlRoot()+t+this.suffix,method:"DELETE",complete:e})},update:function(t,e,n){n=n||function(){},this.ajax({url:this.urlRoot()+t+this.suffix,method:"PUT",data:e,complete:n})}})}),define("model",["extend","localStorageModel","httpModel"],function(t,e,n){var i=function(t){var i;switch(t.storage){case"http":i=new n(t);break;default:i=new e(t)}return i};return i.extend=t,i}),define("viewModel",["knockout","underscore","events","extend","model"],function(t,e,n,i,s){var o=function(n){var i=e.functions(this.observables);i=e.reduce(this.observables,function(t,n,i){return e.isObject(n)&&!e.isArray(n)&&(n.read||n.write)&&t.push(i),t},i),e.each(e.omit(this.observables,i),function(i,s){this[s]=e.isArray(i)?t.isObservable(n[s])?n[s]:t.observableArray((n[s]||i).slice(0)):t.isObservable(n[s])?n[s]:t.observable(n[s]||i),this[s].subscribe(function(t){this.trigger("change:"+s,t)},this)},this),e.each(e.pick(this.observables,i),function(e,n){this[n]=t.computed(this.observables[n],this)},this)},r=function(){},a=function(){var t=this,n=function(){var n={};e.each(t.observables,function(e,i){n[i]=t[i]()}),t.model.save(n,function(){})},i=e.debounce(n,1);this.model.status||(this.model=new s(this.model)),this.autoSync=!0,this.fetch=function(t){var n=this,i=this.autoSync;this.autoSync=!1,this.model.findOne(this[this.idAttribute||"id"](),function(s){e.each(s,function(t,e){"function"==typeof n[e]&&n[e](t)}),n.autoSync=i,e.isFunction(t)&&t()})},e.each(this.observables,function(e,n){t[n].subscribe(function(){t.autoSync&&i()})})},c=function(e){e=e||{},o.call(this,e),this.validation&&r.call(this),this.initialize.call(this,e),this.model&&a.call(this,e),this.autoSync&&this.fetch(),this.el&&t.applyBindings(this,"object"==typeof this.el?this.el:document.querySelector(this.el)[0])};return e.extend(c.prototype,n,{initialize:function(){}}),c.extend=i,c}),define("ko.ninja",["underscore","knockout","viewModel","model"],function(t,e,n,i){return e.ViewModel=n,e.Model=i,e});