!function(t,e){"function"==typeof define&&define.amd?define("ko.ninja.events",["underscore"],e):e(t._,t.ko)}(this,function(t,e){var n,i,o,s,a=/\s+/;return i=function(t,e,n,i){if(!n)return!0;if("object"==typeof n){for(var o in n)t[e].apply(t,[o,n[o]].concat(i));return!1}if(a.test(n)){for(var s=n.split(a),r=0,c=s.length;c>r;r++)t[e].apply(t,[s[r]].concat(i));return!1}return!0},s=function(t,e){var n,i=-1,o=t.length,s=e[0],a=e[1],r=e[2];switch(e.length){case 0:for(;++i<o;)(n=t[i]).callback.call(n.ctx);return;case 1:for(;++i<o;)(n=t[i]).callback.call(n.ctx,s);return;case 2:for(;++i<o;)(n=t[i]).callback.call(n.ctx,s,a);return;case 3:for(;++i<o;)(n=t[i]).callback.call(n.ctx,s,a,r);return;default:for(;++i<o;)(n=t[i]).callback.apply(n.ctx,e)}},n={on:function(t,e,n){if(!i(this,"on",t,[e,n])||!e)return this;this._events=this._events||(this._events={});var o=this._events[t]||(this._events[t]=[]);return o.push({callback:e,context:n,ctx:n||this}),this},once:function(e,n,o){if(!i(this,"once",e,[n,o])||!n)return this;var s=this,a=t.once(function(){s.off(e,a),n.apply(this,arguments)});return a._callback=n,this.on(e,a,o)},off:function(e,n,o){var s,a,r,c,u,f,h,d;if(!this._events||!i(this,"off",e,[n,o]))return this;if(!e&&!n&&!o)return this._events={},this;for(c=e?[e]:t.keys(this._events),u=0,f=c.length;f>u;u++)if(e=c[u],r===this._events[e]){if(this._events[e]=s=[],n||o)for(h=0,d=r.length;d>h;h++)a=r[h],(n&&n!==a.callback&&n!==a.callback._callback||o&&o!==a.context)&&s.push(a);s.length||delete this._events[e]}return this},trigger:function(t){if(!this._events)return this;var e=Array.prototype.slice.call(arguments,1);if(!i(this,"trigger",t,e))return this;var n=this._events[t],o=this._events.all;return n&&s(n,e),o&&s(o,arguments),this},stopListening:function(t,e,n){var i=this._listeners;if(!i)return this;var o=!e&&!n;"object"==typeof e&&(n=this),t&&((i={})[t._listenerId]=t);for(var s in i)i[s].off(e,n,this),o&&delete this._listeners[s];return this}},o={listenTo:"on",listenToOnce:"once"},t.each(o,function(e,i){n[i]=function(n,i,o){var s=this._listeners||(this._listeners={}),a=n._listenerId||(n._listenerId=t.uniqueId("l"));return s[a]=n,"object"==typeof i&&(o=this),n[e](i,o,this),this}}),"function"==typeof define&&define.amd?n:(e.ninjaEvents=n,void 0)}),function(t,e){"function"==typeof define&&define.amd?define("ko.ninja.extend",["underscore"],e):e(t._,t.ko)}(this,function(t,e){var n=function(e,n){var i,o,s=this;return o=e&&t.has(e,"constructor")?e.constructor:function(){return s.apply(this,arguments)},t.extend(o,s,n),i=function(){this.constructor=o},i.prototype=s.prototype,o.prototype=new i,e&&t.extend(o.prototype,e),o.__super__=s.prototype,e.name&&(o.prototype.toString=function(){return e.name}),o};return"function"==typeof define&&define.amd?n:(e.ninjaExtend=n,void 0)}),function(t,e){"function"==typeof define&&define.amd?define("ko.ninja.viewModel",["knockout","underscore","ko.ninja.events","ko.ninja.extend"],e):e(t.ko,t._,t.ko.ninjaEvents,t.ko.ninjaExtend,t.ko.ninjaModel)}(this,function(t,e,n,i){var o=function(n){var i=e.functions(this.observables);i=e.reduce(this.observables,function(t,n,i){return e.isObject(n)&&!e.isArray(n)&&(n.read||n.write)&&t.push(i),t},i),e.each(e.omit(this.observables,i),function(i,o){this[o]=e.isArray(i)?t.isObservable(n[o])?n[o]:t.observableArray((n[o]||i).slice(0)):t.isObservable(n[o])?n[o]:t.observable(n[o]||i),this[o].subscribe(function(t){this.trigger("change:"+o,t)},this)},this),e.each(e.pick(this.observables,i),function(e,n){this[n]=t.computed({read:this.observables[n],write:function(){},owner:this},this)},this)},s=function(){var t=this.model;this.options&&this.options.autoSync&&t.autoSync(this.options.autoSync,!0),e.each(t.observables,function(e,n){this[n]=t[n]},this)},a=function(){var t=this.collections;for(var e in t)t.hasOwnProperty(e)&&(this.options&&this.options.autoSync&&t[e].autoSync(this.options.autoSync),this[e]=t[e]._models)},r=function(e){e=e||{},this.model&&s.call(this,e),this.collections&&a.call(this,e),o.call(this,e),this.initialize.apply(this,arguments),e.el=e.el||this.el,e.el&&t.applyBindings(this,"object"==typeof e.el?e.el:document.querySelector(e.el)[0])};return e.extend(r.prototype,n,{initialize:function(){}}),r.extend=i,"function"==typeof define&&define.amd?r:(t.ninjaViewModel=r,void 0)}),function(t,e){"function"==typeof define&&define.amd?define("ko.ninja.class",["knockout","underscore","ko.ninja.events","ko.ninja.extend"],e):e(t.ko,t._,t.ko.ninjaEvents,t.ko.ninjaExtend)}(this,function(t,e,n,i){var o=function(t){t=t||{},this._setupObservables.call(this,t),this._setup&&this._setup(t),this.initialize(t)};return e.extend(o.prototype,n,{_setupObservables:function(n){if(this.observables&&n){var i;e.each(n,function(t,i){e.isUndefined(this.observables[i])||(this.observables[i]=t,delete n[i])},this),i=e.functions(this.observables),i=e.reduce(this.observables,function(t,n,i){return e.isObject(n)&&!e.isArray(n)&&(n.read||n.write)&&t.push(i),t},i),e.each(e.omit(this.observables,i),function(i,o){this[o]=e.isArray(i)?t.isObservable(n[o])?n[o]:t.observableArray((n[o]||i).slice(0)):t.isObservable(n[o])?n[o]:t.observable(n[o]||i),this[o].subscribe(function(t){this.trigger("change:"+o,t)},this)},this),e.each(e.pick(this.observables,i),function(e,n){this[n]=t.computed({read:this.observables[n],write:function(){},owner:this},this)},this)}},initialize:function(){}}),o.extend=i,"function"==typeof define&&define.amd?o:(t.ninjaClass=o,void 0)}),function(t,e){"function"==typeof define&&define.amd?define("ko.ninja.baseStorage",["underscore","ko.ninja.events","ko.ninja.extend"],e):e(t._,t.ko.ninjaEvents,t.ko.ninjaExtend,t.ko)}(this,function(t,e,n,i){var o=function(n){n=n||{},t.isFunction(this.initialize)&&this.initialize(n),t.extend(this,e,{options:{},idAttribute:"id",invalid:function(){return localStorage?this.options.name?void 0:{error:!0,message:"This storage has no name. Every storage needs a name"}:{error:!0,message:"There is no localStorage available in this context"}},save:function(e,n){return e||(e={},t.each(this.observables,function(t,n){e[n]=this[n]()},this)),e[this.idAttribute]?this.update(e[this.idAttribute],e,n):this.insert(e,n)},fetch:function(){}},n)};return o.extend=n,"function"==typeof define&&define.amd?o:(i.ninjaBaseStorage=o,void 0)}),function(t,e){"function"==typeof define&&define.amd?define("ko.ninja.localStorage",["ko.ninja.baseStorage"],e):e(t.ko.ninjaBaseStorage,t.ko)}(this,function(t,e){var n=t.extend({find:function(t,e){var n,i=[];if(e=e||t,this.invalid())e(this.invalid(t));else{for(var o in localStorage)if(~o.indexOf(this.options.name+"-")){n=!0;for(var s in t)t[s]!==JSON.parse(localStorage[o])[s]&&(n=!1);n&&i.push(JSON.parse(localStorage.getItem(o)))}e(i)}},findOne:function(t,e){this.invalid()?e(this.invalid()):e(JSON.parse(localStorage[this.options.name+"-"+t]||"{}"))},insert:function(t,e){e=e||function(){},t[this.idAttribute]=(new Date).getTime(),this.invalid(t)?e(this.invalid(t)):(localStorage[this.options.name+"-"+t.id]=JSON.stringify(t),e(t))},remove:function(t,e){e=e||function(){},t=t||this.getId(),this.invalid()?e(this.invalid()):(delete localStorage[this.options.name+"-"+t],e(null))},update:function(t,e,n){n=n||function(){},this.invalid(e)?n(this.invalid(e)):(e[this.idAttribute]=t,localStorage[this.options.name+"-"+t]=JSON.stringify(e),n(e))},initialize:function(t){t&&t.options&&(this.options=t.options)}});return"function"==typeof define&&define.amd?n:(e.ninjaLocalStorageModel=n,void 0)}),function(t,e){"function"==typeof define&&define.amd?define("ko.ninja.ajax",[],e):e(t.ko)}(this,function(t){var e=function(t,e){var n,i=this;this.updating=!1,this.abort=function(){i.updating&&(i.updating=!1,i.AJAX.abort(),i.AJAX=null)},this.update=function(t,e){return i.updating?!1:(i.AJAX=null,i.AJAX=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),null===i.AJAX?!1:(i.AJAX.onreadystatechange=function(){4===i.AJAX.readyState&&(i.updating=!1,i.callback(i.AJAX.responseText,i.AJAX.status,i.AJAX.responseXML),i.AJAX=null)},i.updating=new Date,/post/i.test(e)?(n=o+"?"+i.updating.getTime(),i.AJAX.open("POST",n,!0),i.AJAX.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.AJAX.send(t)):/put/i.test(e)?(n=o+"?"+i.updating.getTime(),i.AJAX.open("PUT",n,!0),i.AJAX.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.AJAX.send(t)):/delete/i.test(e)?(n=o+"?"+i.updating.getTime(),i.AJAX.open("DELETE",n,!0),i.AJAX.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.AJAX.send(t)):(n=o+"?"+t+"&timestamp="+i.updating.getTime(),i.AJAX.open("GET",n,!0),i.AJAX.send(null)),!0))};var o=t;this.callback=e||function(){}};return"function"==typeof define&&define.amd?e:(t.ninjaAjax=e,void 0)}),function(t,e){"function"==typeof define&&define.amd?define("ko.ninja.httpStorage",["ko.ninja.baseStorage","ko.ninja.ajax","underscore"],e):e(t.ko.ninjaBaseStorage,t.ko.ninjaAjax,t._,t.ko)}(this,function(t,e,n,i){var o=t.extend({suffix:"",urlRoot:function(){return(this.options.name?"/"+this.options.name:"")+"/"},ajax:function(t){var i;"function"==typeof $&&$.ajax?$.ajax(n.extend({success:function(e){t.complete(e)}.bind(this),error:function(e){t.complete({error:!0,message:e})}.bind(this)},t)):(i=new e(t.url,function(e){n.isFunction(t.complete)&&t.complete(JSON.parse(e))}),i.update((JSON.stringify(t.data)||"").replace(/:/g,"=").replace(/"/g,"").replace(/,/g,"&").replace(/{/g,"").replace(/}/g,""),t.method))},find:function(t,e){this.ajax({url:this.urlRoot()+this.suffix,method:"GET",data:t,complete:e||t})},findOne:function(t,e){this.ajax({url:this.urlRoot()+t+this.suffix,method:"GET",complete:e})},insert:function(t,e){e=e||function(){},this.ajax({url:this.urlRoot()+this.suffix,method:"POST",data:t,complete:e})},remove:function(t,e){e=e||function(){},t||(t=this.getId()),this.ajax({url:this.urlRoot()+t+this.suffix,method:"DELETE",complete:e})},update:function(t,e,n){n=n||function(){},t||(t=this.getId()),this.ajax({url:this.urlRoot()+t+this.suffix,method:"PUT",data:e,complete:n})}});return"function"==typeof define&&define.amd?o:(i.ninjaHttpStorage=o,void 0)}),function(t,e){"function"==typeof define&&define.amd?define("ko.ninja.socketStorage",["ko.ninja.baseStorage","underscore"],e):e(t.ko.ninjaBaseStorage,t._,t.ko)}(this,function(t,e,n){var i=t.extend({find:function(t,e){e||(e=t),this.socket.emit(this.messageNames.find,{data:t},e)},findOne:function(t,e){t||(t=this.getId()),this.socket.emit(this.messageNames.findOne,{id:t},e)},insert:function(t,e){this.socket.emit(this.messageNames.insert,{data:t},e)},remove:function(t,e){t||(t=this.getId()),this.socket.emit(this.messageNames.remove,{id:t},e)},update:function(t,e,n){t||(t=this.getId()),this.socket.emit(this.messageNames.update,{id:t,data:e},n)},initialize:function(t){t=t||{},this.options=e.extend({protocol:"http",hostName:"localhost",port:8080,name:"list"},t.options||{}),this.socket=io.connect(this.options.protocol+"://"+this.options.hostName+":"+this.options.port),this.messageNames=e.extend({update:this.options.name+"-update",insert:this.options.name+"-insert",find:this.options.name+"-find",findOne:this.options.name+"-findOne",remove:this.options.name+"-remove"},this.options.messageNames||{})}});return"function"==typeof define&&define.amd?i:(n.ninjaSocketStorage=i,void 0)}),function(t,e){"function"==typeof define&&define.amd?define("ko.ninja.storage",["ko.ninja.extend","ko.ninja.localStorage","ko.ninja.httpStorage","ko.ninja.socketStorage"],e):e(t.ko.ninjaExtend,t.ko.ninjaLocalStorageStorage,t.ko.ninjaSocketStorage)}(this,function(t,e,n,i){var o=function(t){var o;if(!t||!t.options||!t.options.storage)return{};switch(t.options.storage){case"http":o=new n(t);break;case"socket.io":o=new i(t);break;case"localStorage":o=new e(t)}return o};return o.extend=t,"function"==typeof define&&define.amd?o:(ko.ninjaStorage=o,void 0)}),function(t,e){"function"==typeof define&&define.amd?define("ko.ninja.validation",["knockout","underscore"],e):e(t.ko,t._)}(this,function(t,e){var n={validationTypes:{_custom:function(t,e){return e.validator.call(this,t,e)},_maxLength:function(t,e){return t.length>e.value},_minLength:function(t,e){return t.length<e.value},_length:function(t,e){return t.length!==e.value},_required:function(t){return!t||!t.length},_email:function(t){return!/[^\s@]+@[^\s@]+\.[^\s@]+/.test(t)},_number:function(t){return!(!isNaN(parseFloat(t))&&isFinite(t))}},_validate:function(t,n){var i=this[n]?this[n]():null,o=[];return e.each(t,function(t,e){if(this.validationTypes["_"+e]){var s=this.validationTypes["_"+e].call(this,i,t);s&&("string"==typeof t&&(t={message:t}),o.push({observable:n,error:t.message}))}},this),o},validateOne:function(t){var e=this._validate(this.validation[t],t);return e.length?e[0].error:void 0},validateAll:function(){var t=[];return e.each(this.validation,function(e,n){t=t.concat(this._validate(e,n))},this),t},validate:function(){var t={};return this.errors(this.validateAll()),e.each(this.errors(),function(e){t[e.observable]||(this[e.observable].error(e.error),t[e.observable]=!0)},this),this.errors().length?this.errors():null},watchValidation:function(e){this[e]&&(this[e].error=t.observable(),this[e].subscribe(function(){this[e].error(this.validateOne(e)),this.errors(this.validateAll())}.bind(this)))},watchValidations:function(){this.errors=t.observableArray(),e.each(this.validation,function(t,e){this.watchValidation(e)},this)}};return"function"==typeof define&&define.amd?n:(t.ninjaValidation=n,void 0)}),function(t,e){"function"==typeof define&&define.amd?define("ko.ninja.model",["underscore","ko.ninja.class","ko.ninja.extend","ko.ninja.storage","knockout","ko.ninja.validation"],e):e(t._,t.ko.ninjaClass,t.ko.ninjaExtend,t.ko.ninjaStorage,t.ko,t.ko.ninjaValidation)}(this,function(t,e,n,i,o,s){var a=e.extend(t.extend(s,{idAttribute:"id",getId:function(){return this[this.idAttribute]()},_setup:function(e){t.extend(this,new i(t.extend({},this,e))),this.validation&&this.watchValidations()},get:function(t){if(!this[t])throw"get observable not found";return this[t]()},set:function(e,n){if(t.isObject(e))for(var i in e)e.hasOwnProperty(i)&&this.set(i,e[i]);else t.isFunction(this[e])&&this[e]()!==n&&this[e](n)},has:function(t){return this[t]?!!this[t]():void 0},clear:function(){t.each(this.observables,function(t,e){this[e](null)},this)},toJSON:function(){var e={};return t.each(this.observables,function(t,n){e[n]=this[n]()},this),e},autoSync:function(e,n){var i=this;e&&(n&&this.findOne(this.getId(),function(t){i.set(t)}),t.each(this.observables,function(t,e){this[e].subscribe(function(){i.save()})},this))}}));return a.extend=n,"function"==typeof define&&define.amd?a:(o.ninjaModel=a,void 0)}),function(t,e){"function"==typeof define&&define.amd?define("ko.ninja.collection",["ko.ninja.extend","knockout","underscore","ko.ninja.storage"],e):e(t.ko.ninjaExtend,t.ko,t._,t.ko.ninjaStorage)}(this,function(t,e,n,i){var o=function(t){this.options=this.options||{};var o={},s=!1,a=i.extend({}),r=new a({options:this.options});n.extend(this,{_models:e.observableArray([]),toJSON:function(){for(var t=this._models(),e=[],n=0;n<t.length;n++)e.push(t[n].toJSON());return e},insert:function(t,e){var i;t[this.model.prototype.idAttribute]||(t[this.model.prototype.idAttribute]=null),t.options=n.extend(this.options,this.model.prototype.options||{}),i=new this.model(t),e&&n.isNumber(e.position)?this._models.splice(e.position,0,i):this._models.push(i),s&&i.save&&i.save(null,function(t){i.set(t)})},remove:function(t){var e;if(t)if(n.isArray(t))for(e=0;e<t.length;e++)this.remove(t[e]);else for(e=0;e<this._models().length;e++)this._models()[e].getId()===t&&(s&&this._models()[e].remove&&this._models()[e].remove(),this._models.splice(e,1))},find:function(t){var e=[],n=!0;if(o=t||{}){for(var i=0;i<this._models().length;i++){n=!0;for(var s in o)o.hasOwnProperty(s)&&o[s]!==this._models()[i][s]()&&(n=!1);n&&e.push(this._models()[i])}return e}return this._models()},fetch:function(t){var e=this,i=[];t=t||o||{},r.find&&r.find(t,function(t){for(var o=0;o<t.length;o++)i.push(new e.model(n.extend(t[o],{options:n.extend(e.options,e.model.prototype.options||{})})));e._models(i)})},get:function(t){for(var e,n=0;n<this._models().length;n++)this._models()[n].getId()===t&&(e=this._models()[n]);return e},count:function(){return this._models().length},sort:function(t,e){this._models.sort(function(n,i){return e?n[t]()<i[t]():n[t]()>i[t]()})},autoSync:function(t){var e=this._models();t?(this.fetch(),s=!0):s&&(s=!1);for(var n=0;n<e.length;n++)e[n].autoSync(t)}}),this.model&&(this.model.prototype.storage=this.storage,n.each(t||[{}],this.insert,this))};return o.extend=t,"function"==typeof define&&define.amd?o:(e.ninjaCollection=o,void 0)}),function(t,e){"function"==typeof define&&define.amd?define("ko.ninja",["underscore","knockout","ko.ninja.viewModel","ko.ninja.model","ko.ninja.collection"],e):e(t._,t.ko,t.ko.ninjaViewModel,t.ko.ninjaModel,t.ko.ninjaCollection)}(this,function(t,e,n,i,o){return e.ViewModel=n,e.Model=i,e.Collection=o,"function"==typeof define&&define.amd?e:void 0});